<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Creative PDF Viewer</title>
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.min.js"></script>
  <style>
    body { background: #23272f; color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; }
    #controls { background: #3a3f4a; padding: 10px; display: flex; gap: 10px; align-items: center; }
    #pdf-canvas { display: block; margin: 20px auto; background: #fff; border-radius: 4px; box-shadow: 0 3px 12px #0002; }
    button { background: #ff6600; color: #fff; border: none; padding: 8px 14px; border-radius: 4px; cursor: pointer; font-weight: bold; }
    button:disabled { background: #999; }
    #page-info { margin: 0 10px; }
    #exit { margin-left: auto; background: #f33; }
  </style>
</head>
<body>
  <div id="controls">
    <button id="prev">Previous</button>
    <span id="page-info">Page 1 / ?</span>
    <button id="next">Next</button>
    <button id="exit">Exit</button>
  </div>
  <canvas id="pdf-canvas"></canvas>
  <script>
    // PDF.js setup
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.worker.min.js';

    const PDF_URL = 'myfile.pdf'; // Change if your PDF has a different path/name
    const STORAGE_KEY = 'my_pdf_lastpage';

    let pdfDoc = null, pageNum = 1, pageCount = 0, rendering = false;
    const canvas = document.getElementById('pdf-canvas');
    const ctx = canvas.getContext('2d');
    const pageInfo = document.getElementById('page-info');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const exitBtn = document.getElementById('exit');

    // Load last page from localStorage
    function loadLastPage() {
      const stored = localStorage.getItem(STORAGE_KEY);
      return stored ? parseInt(stored, 10) : 1;
    }

    function saveLastPage() {
      localStorage.setItem(STORAGE_KEY, pageNum);
    }

    // Render a page
    async function renderPage(num) {
      rendering = true;
      const page = await pdfDoc.getPage(num);
      const viewport = page.getViewport({ scale: 1.5 });
      canvas.height = viewport.height;
      canvas.width = viewport.width;
      await page.render({
        canvasContext: ctx,
        viewport: viewport
      }).promise;
      pageInfo.textContent = `Page ${num} / ${pageCount}`;
      prevBtn.disabled = num <= 1;
      nextBtn.disabled = num >= pageCount;
      rendering = false;
      saveLastPage();
    }

    // Navigation
    prevBtn.onclick = () => { if(pageNum > 1 && !rendering) renderPage(--pageNum); };
    nextBtn.onclick = () => { if(pageNum < pageCount && !rendering) renderPage(++pageNum); };

    // Exit button
    exitBtn.onclick = () => {
      saveLastPage();
      alert('Exit! Your position will be remembered.');
      // Optional: Hide viewer, show message, or close tab
      document.body.innerHTML = '<h1 style="text-align:center; margin-top:100px;">You have exited the PDF.<br>Your position was saved.<br><br><button onclick="location.reload()">Reopen PDF</button></h1>';
    };

    window.addEventListener('beforeunload', saveLastPage);

    // Init
    (async function() {
      pdfDoc = await pdfjsLib.getDocument(PDF_URL).promise;
      pageCount = pdfDoc.numPages;
      pageNum = Math.min(Math.max(loadLastPage(), 1), pageCount);
      renderPage(pageNum);
    })();
  </script>
</body>
</html>
